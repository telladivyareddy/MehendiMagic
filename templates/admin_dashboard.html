<!DOCTYPE html>
<html>
<head>
    <title>Admin Dashboard - MehendiMagic</title>
    <style>
        table {
            border-collapse: collapse;
            margin-bottom: 30px;
            width: 100%;
        }
        th, td {
            border: 1px solid #888;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #ddd;
        }
        form {
            margin: 10px 0;
        }
    </style>
</head>
<body>

<h2>Welcome, Admin {{ user.name }}</h2>

<h3>👤 All Users</h3>
<table>
  <tr><th>Name</th><th>Email</th><th>Role</th><th>Actions</th></tr>
  {% for u in users %}
  <tr>
    <td>{{ u.name }}</td>
    <td>{{ u.email }}</td>
    <td>{{ u.role }}</td>
    <td>
      {% if u.email != user.email %}
      <form action="{{ url_for('admin_delete_user') }}" method="POST" style="display:inline;">
        <input type="hidden" name="email" value="{{ u.email }}">
        <button type="submit">🗑️ Delete</button>
      </form>
      {% else %}
      (You)
      {% endif %}
    </td>
  </tr>
  {% endfor %}
</table>

<h3>📅 All Appointments</h3>
<table>
  <tr>
    <th>Client</th><th>Artist</th><th>Date</th><th>Time</th><th>Status</th>
  </tr>
  {% for a in appointments %}
  <tr>
    <td>{{ a.client_email }}</td>
    <td>{{ a.artist_email }}</td>
    <td>{{ a.date }}</td>
    <td>{{ a.time }}</td>
    <td>{{ a.status }}</td>
  </tr>
  {% endfor %}
</table>

<h3>📈 Artist Booking Stats</h3>
<table>
  <tr><th>Artist Email</th><th>Total Bookings</th></tr>
  {% for artist, count in artist_stats.items() %}
  <tr>
    <td>{{ artist }}</td>
    <td>{{ count }}</td>
  </tr>
  {% endfor %}
</table>

<h3>➕ Add New User</h3>
<form method="POST" action="{{ url_for('admin_add_user') }}">
    <label>Name:</label><br>
    <input name="name" placeholder="Name" required><br>
    
    <label>Email:</label><br>
    <input name="email" placeholder="Email" required><br>
    
    <label>Password:</label><br>
    <input name="password" placeholder="Password" required type="password"><br>
    
    <label>Role:</label><br>
    <select name="role">
        <option value="client">Client</option>
        <option value="artist">Artist</option>
    </select><br><br>
    
    <button type="submit">Add User</button>
</form>

<br>
<a href="{{ url_for('logout') }}">Logout</a>

</body>
</html>
